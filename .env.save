cd /srv/backend

# 1. Make sure .env exists with DATABASE_URL
cat .env | grep DATABASE_URL

# 2. Generate Prisma Client
npx prisma generate

# 3. Apply database migrations (if needed)
npx prisma migrate deploy

# 4. Apply lifecycle view
node scripts/applyLifecycleView.js

# 5. Run the poller
node workers/gmailPoller.jsPORT=3001
DATABASE_URL=postgresql://user:password@localhost:5432/piercely
JWT_SECRET=your-secret-key-change-this
NODE_ENV=development
SQUARE_ACCESS_TOKEN=your-square-token
OPENAI_API_KEY=your-openai-key

# Email Configuration (for customer and staff notifications)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Staff Notifications
STAFF_NOTIFICATION_EMAIL=staff@sodapoppiercing.com

# SMS Configuration (Twilio)
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# Frontend URL (for links in notifications)
FRONTEND_URL=http://localhost:5173
